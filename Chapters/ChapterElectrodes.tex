% Chapter Electrodes

\chapter{Electrodes Design with Electrostatic Simulation} % Main chapter title

\label{ChapterElectrodes} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

%----------------------------------------------------------------------------------------
%	BEGING CHAPTER
%----------------------------------------------------------------------------------------

Let me tell you about my work with an electrostatic simulation software called COMSOL.
That was quite nice. Just designing the detector and the aluminium electrodes with a beautiful and efficient interface.
Thanks to that, I could simulate a lot of configuration and geometry to probe for the finest results out there.
Finest meaning a lot of fiducial volume, good charge collection, and low electric capacity.
A usual impossible to solve problem which lead to a lot of trade-off in itself, without adding the issues about the heat channel.
But hey, I could obtain some nice plots and tables, check them out.


\section{Electrodes as Sensors for the Ionization Channel}

\subsection{Basics of the Ionization channel}

The ionization channels aims at converting the ionization of the germanium into a voltage signal.
This is done with the use of aluminium electrodes acting as the terminals of a capacitor of capacitance $C$. When collecting an electric charge $\Delta Q$, a voltage $\Delta U$ is created across the capacitor such as:

\begin{equation}
C = Q \times U \quad \Leftrightarrow \quad U \times = \frac{C}{Q}
\label{eq:capacitor-basic}
\end{equation}

A high sensitivity of the ionization channel means that the created voltage $\Delta V$ is maximized. The equation \label{eq:capacitor-basic} shows that a low capacitance $C$ of the electrodes and a high collection of electric charge $\Delta Q$ increase the ionization channel response. While the amount of electric charge $\Delta Q$ can depend of the electric field shape, in the case of a theoretically perfect charge collection, the number of electron-hole pairs created and collected only depends on the recoil energy $E_R$ of the interacting particle $i$ and the associated quenching factor $Q^i(E_R)$. This factor depends only on the material used as absorber, in our case Germanium.
The capacitance depends on the design of the detector, and is the one of the main quantities used to quantify the performance of a detector design.


\subsection{Germanium as Semiconductor}

The material used as absorber for the detectors is semi-conducting High Purity Germanium [ref?].
This paragraph focuses on its characteristics and also compares it to materials used by others experiments using bolometers.

The use of semi-conducting Germanium as an absorber was first proposed by Taverdale? and Evvan [80, Emeline].
Along with an increase in temperature, a semi-conducting germanium also features a phenomenon of ionization caused by a particle interaction. Such electronic and nuclear recoils form electron-hole pairs of average energy $\epsilon = 3 eV/pair$. This energy corresponds to the gap energy separating the valence and conduction electronic bands in the germanium in its semi-conducting state accessible for temperature below 77K.

In order to understand the physical properties of a semi-conductor, we can consider the theory of energy bands. In a solid material, at rest electrons are occupying the lowest state of energy according to their fermion nature. This lowest state of energy are strongly linked to the nucleus, forming the valence electronic band of energy. Higher energy states are able to interact with neighboring atoms and compose the conduction electronic band of energy.
conducting, not conducting, semi-conductor. Small gap. blablabla

The semi-conducting properties of a germanium crystal heavily depends on the impurities affecting it. With the Germanium element being of valence 4, there exist two kind of impurities:
\begin{itemize}
	\item acceptor impurities of valence 3 producing a p-type germanium,
	\item donor impurities of valence 5 producing an n-type germanium.
\end{itemize}
These impurities creates intermediary energy steps in the semi-conducting germanium band gap accessible to electric charges (as seen in figure \ref{fig:conduction-bands}). The presence if this intermediate accessible energy bands has several consequences on the ionization channel. It reduces the energy necessary to create an electron-hole pair, thus creating additional noise and biasing for the ionization channel. Then, it creates a trapping phenomenon which prevent electric charge carriers from reaching the electrodes. With trapped charges in the crystal, a counter electric field slowly generates, reducing the sensitivity of the electrodes. Finally, these impurities lower the global resistivity of the germanium crystal and increase the leakage current.
The semi-conducting germanium use as absorber thus should contain the lowest amount of impurities in order to have a detector with good performances.
The study of the trapping in EDELWEISS detector and the impact of impurities is presenting in [ref quentin 80].
We define $N_a$ and $N_d$ as the number of acceptor and donor impurities respectively. We  can have access (how?) to the absolute difference of this quantities $|N_a - N_d|$ which determine the number of available charge carriers.
The material used as absorber is High-Purity Germanium (HPGe) with an estimated:
$$ 10^{9} < |N_a - N_d| < 10^{10} \textsf{cm}^{-3}$$
which corresponds to less than one impurity atom for $10^{12}$ germanium atoms. With this material, low leakage currents of few pA can be achieved for the usual operating  electric field range of a few V/cm.

Ok, so here might be some mumbo jumbo concerning the p-n junction in a semi-conductor. Is it useful ? idk.
A recurring term is "depletion depth" which apparently is inversely proportional to the impurity concentration.
A germanium crystal with good performance should present a high resistivity obtainable with a high depletion depth.
As a result, the EDELWEISS and RICOCHET experiment use high purity germanium (HPGe) with special treatment [ref?] leading to a low impurity concentration of less than $10^{10}$ atoms.cm${-3}$ (1 impurity for $10^{12}$ germanium atoms) whereas a normal germanium crystal possesses a concentration of about $10^{13}$ atoms.cm${-3}$.

Comparing the germanium to silicium:
\begin{itemize}
	\item higher Z, so better quenching factor [lindhard]
	\item denser material, better for exposure
	\item low impurities, big depletion region
	\item low ionization energy (gap?)
	\item high conductivity (?)
\end{itemize}

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Figures/Electrodes/conduction_bands.pdf}
\caption{Scheme of the conduction bands for semiconductor, insulator and conductor materials.}
\label{fig:conduction-bands}
\end{figure}


\subsection{Electric Charge Drifting in Crystal}

{\color{red}
Alex B. biblio here.
Also explainin trapping, charge collection.
}

The study of charge migration in EDELWEISS germanium crystal is presentend in [ref Emeline 82] taking into account the crystallographic structure of the germanium crystal. In this study, Alex.B simulates numerically the drifting of eletrons and holes in a 200g FID Edelweiss detector with bulk interaction of gamma-rays of energy 348keV. The charge trajectories are presented in the figure \ref{fig:charge-drifting}. He also follows the generation of the voltage signal on the electrodes. This is consistent with Ramo field theory which will be described later.

When interacting with the atoms of a germanium crystal, a particle deposits a so-called recoil energy. The word "recoil" references to the elastic diffusion of the incoming particle on a germanium nuclei, this is a nuclear recoil, or the elastic diffusion of the electronic cloud of a germanium atom, this is an electronic recoil. A fraction of the recoil energy is used for the creation of electron-hole pairs, this process is known as ionization. This fraction is called quenching factor $Q$ whose value depends on the recoil type, the incoming particle, and the recoil energy. When a electron-hole pair is created, a valence electron is going into the conducting band of the semi-conducting germanium crystal (as illustrated in the figure \ref{fig:conduction-bands}) while a hole appears in the valence band. Following a recoil, electrons can excited with energies much greater than the germanium gap energy. However, such electrons relaxes by phonon emission and creation of new electon-hole pairs. We can consider that after relaxation, the number of electron-hole pairs $N^j$ induced by a recoil of type $j \in {e(lectronic), n(uclear)}$ is expressed as:
\begin{equation}
\label{eq:number-pairs}
N^j = Q^j \left( E_R \right) \frac{E_R}{\epsilon}
\end{equation}
with $\epsilon$ the average energy necessary for the formation of an electron-hole pair and $Q^j$ the quenching factor function of $E_R$ the recoil energy.

The average energy $\epsilon$ contained in a pair is greated than the germanium gap band of $0.67\textsf{eV}$ as it also take into account the momentum associated to the interaction between the pair and the crystal. The figure \ref{fig:band-structure} represents the lower energy of the valence band and the higher energy of the conduction band in a germanium crystal depending on the orientation (orientation of what ? germanium crystallography, electron momentum ?). While the absolute lowest energy of the conducting band, at [111] and the highest energy of the valence band, at [000], are separated by the germanium gap energy of $0.67\textsf{eV}$, this extremum does not correspond to the same orientation $\bm{k}$, the germanium gap is indirect. An electron can transition into the conducting band with the transfer of a momentum $\bm{k}$ from the phonon in order to respect the conservation of momentum and energy (as described in [ref quentin 87]). In the end, the average energy of a pair in germanium is estimated to [ref necessary]:
\begin{equation}
\label{eq:energy-pair}
\epsilon = 3 \textsf{eV}
\end{equation} 

The number of created pairs $N^j$ is subject to fluctuation and thus impose itself as an intrinsic limit to the resolution of the ionization channel. The number of pairs $N^j$ should be expected to follow a Poisson distribution of standard deviation $\sigma(N^j) = \sqrt{N^j}$. However, the observed fluctuation are lower than expected and could be explained by a correlation of the relaxation process of the phonons and electron-hole pairs. The paper [ref 85 quentin] propose a standard deviation expressed as:
\begin{equation}
\sigma(N^j) = 2.35 \sqrt{F \epsilon E_R / Q(E_R)}
\end{equation}
with an introduced Fano factor $F$ of about 0.1 for the germanium. Considering the current range of ionization channel resolution, the fluctuation of the number of pairs created by ionization could be limiting with $\sigma(N^j) \approx 300\textsf(eV)$ which could be obtained for (electronic) recoil energy greater than $300\textsf{keV}$. As we are interested in the lowest energy range and the experiments presented in this work use calibration peaks of energy $\approx 10keV$, the impact of these fluctuation are negligible (especially considering other effects such as the trapping, the electronic noise, etc..).

As will be seen in the next paragraph, the voltage signal generated at the electrodes is based on the charge movement and is only partially affected by the fact that the charge is indeed collected by the electrode. The signal last a few microseconds with a speed of the charge carrier of a few cm/$\mu$s.
Also, the electrons tends to travel following inter-valleys in the crystal with a certain angle while the hole travel independently of the crystal orientation. This is problematic for a good charge collection and "herding" of the electron by the electric field.


\begin{figure}
\centering
\includegraphics[height=0.5\textheight]{Figures/Electrodes/band_structure.pdf}
\caption{Scheme of the band structure in a germanium crystal.}
\label{fig:band-structure}
\end{figure}

\begin{figure}
\centering
\includegraphics[height=0.5\textheight]{Figures/Electrodes/charge_drifting.pdf}
\caption{Scheme of the band structure in a germanium crystal.}
\label{fig:charge-drifting}
\end{figure}


\subsection{DAQ and electronics for ionization}

The electronics used for the ionization and the heat channel uses Junction Field Effect Transistor (JFET) which are operated at a low temperature of 100K inside the cryostat.
Some mumbo jumbo about the bolo-box (is it necessary ?).
The figure \ref{fig:electronics-scheme} show the scheme of the cold electronics for the heat channel (on the left) and the ionization channel (on the right).

\begin{figure}
\centering
\includegraphics[width=\textwidth]{Figures/Electrodes/electronics_scheme.pdf}
\caption{Scheme of the cold electronics readout for the heat channel (left) and the ionization channel (right)}
\label{fig:electronics-scheme}
\end{figure}

In most experiments (source?), the ionization channel readout is done with the integration of the drifting charge current on the feedback capacitance of a charge amplifier. However, the EDELWEISS electronics directly measures the electric potential of the electrodes with a voltage amplifier. As each electrode is considered as a terminal of a capacitor $C_{electrode}$, the measured voltage is:
\begin{equation}
U = \frac{Q}{C_{electrode}}
\end{equation}
with $Q$ the drifting charge seen by the electrode.
Compare with a charge amplifier, the voltage amplifier does not involve any resistor in the amplification scheme, resulting a lower noise. However, the use of a voltage amplifier is only possible with a low leakage current, lower than 0.1fA (good for EDELWEISS, but is this possible for RICOCHET with operation on surface).

The ionization channel readout being based on the collection of electric charges, the renewal of the electric potential of the electrodes is necessary to maintain the voltage bias of the detector and to prevent the signal from leaving the readout range [-32000, +32000]. This operation, called a “reset”, consists in linking each electrodes to a polarization circuit of fixed electric potential. The linking is assured with mechanical relays (motivated by publication?) represented as a switch on the electronics scheme. The period of the resets is of a few seconds and should be adjusted empirically to the operated detectors and the event rates. In the case of surfaces operation at IP2I, the event rate is high and lot of charges are accumulated which needs for a shorter period than an underground operation at the LSM.
One should note the double switch of the mechanical relays accompanying each reset induces an artifact signal on both the heat and ionization channel. While easily discriminable from real events, these artifact signal result in dead time during which the detector is not available for valid event recording. Thus a short period of reset is not wanted.

While the majority of the electric charges produces by the ionization process are collected by the electrodes, some become trapped in the crystal (impurities) or on the surfaces of the crystal. These trapped charges are slowly accumulating and creating a counter electric field in the absorber. This results in a lower electric field perceived in the bulk of the detector which hampers a correct charge collection and decreases the sensitivity of the electrodes.
A procedure called “maintenance” is used to periodically shake up the trapped charges. These maintenances prevent, or at least slow significantly, the counter field build-up in the detector. A maintenance consists of a minute of multiples relay switches and relay changeovers. This procedure continuously invert the voltage bias in the detector, eventually destabilizing the trapped charges which are left to drift and collection in the electrodes.
During a maintenance, the detector is not available for data taking. The frequency of maintenance should be low to lower the dead time. For above ground operation, the usual maintenance period is of about 30 minutes and should be empirically adjusted to the detector and the event rate.

While a maintenance shakes up the majority of the trapped electric charges, a small fraction is not affected and participates to build up the counter field. These remaining charges are deeply trapped and need for a stronger perturbation to be freed. The detector is therefore periodically submitted to a procedure called "regeneration" aiming at a full reset of any passive electric field in the germanium crystal. With the electrodes being grounded, an intense gamma-ray radioactive source irradiates the detector. The high frequency of high energy recoils produces ionization in the whole crystal which eventually neutralize the accumulated space charges. 
As for the reset and maintenance procedures, the period between two regenerations should be empirically adjusted to the measured charge accumulation while not too frequent to avoid supplementary dead times. For above-ground operation, regeneration are realized ever two days (with a 1Cu cesium source).

Between each maintenance, the detector stays floating. The common noise can be subtracted when considering the charge conservation for all the electrodes:
\begin{equation}
\label{eq:charge-conservation}
A + B + C + D = 0
\end{equation}
With a linear combination of the raw ionization channels (A,B,C,D), we obtain new quantities (A’, B’, C’, D’) corrected from this common noise:
\begin{equation}
\label{eq:common-noise-subtraction}
A’ = \frac{3}{4} A - \frac{1}{4} \left( B + C + D \right)
\end{equation} 
The decrease of the noise level can be appreciated in the figure \ref{fig:ionization-noise} showing the noise spectrum affecting the different ionization channels before and after linear combination.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{Figures/Electrodes/ionization_noise.pdf}
\caption{Average noise amplitude (in nV / Hz ) as a function of frequency of the
ionization channel for an EDELWEISS detector. The black histogram corresponds to the
noise before the correlated noise correction and the purple histogram to the noise after
the correction. Left: frequencies below 500 Hz. Right: high frequency part. [Emeline caption]}
\label{fig:ionization-noise}
\end{figure}

The ionization channel readout is sampled at an initial 100kHz. This means the period of the  measurement points is 10$\mu$s which greater than the estimated time span of an ionization signal of a few $\mu$s [ref necessary Alex.B ?]. As a result, an ionization signal is recorded as an Heaviside function. No information can be obtained on the shape of the signal.
The high readout sampling was historically chosen in EDELWEISS for the purpose of triggering on the ionization channel with a good temporal resolution (is it true ?). The highly sampled ionization signal is then averaged in order to produce a signal of frequency $f_s$ of about 400Hz. This lower sampling is able to record the information contained in the ionization Heaviside signal (its amplitude mainly) while being lightweight in term of disk space, which is essential considering the recording and processing resources at our disposal. The saved ionization signal of sampling frequency $f_s$ is composed of points which are averages of $100kHz/f_s$ points. The saved signal is therefore a skewed Heaviside-like function (more info needed? Is this work using this fact?).

Should I talk about the HEMT technology ? The expected resolution and noise level ?


\subsection{Aluminum Deposition}

*Stefanos biblio here.*

The electrodes of the detectors are made by depositing aluminium on the surface of the germanium crystal. The aluminium deposition is carried out by the research group at CSNSM at Orsay. The deposition processes are still being improved.

The germanium crystal is placed in vacuum chamber where its surface is altered with beams of vaporized atoms (hydrogen, aluminium, xenon…). 
In order to prevent the surface leakage, a highly resistive layer is created under the aluminium electrodes. It is a 60 to 80 nm deep amorphous layer of hydrogenated germanium.

Two techniques are used for the detectors presented in this work: evaporation with mask and the (photo)lithography.
A solid mask can set between the beam source and the crystal in order to shape the altered surface. In the case of concentric circular electrode, the mask (presented in figure {fig:mask-evaporation}) consists in several curved slits which allow the passage of vaporized aluminium. By rotating the mask during the process, the aluminium is deposited in a ring pattern on the germanium.
Another method to control the shape of the electrode is to use photolitography. First, the whole surface of the crystal is covered with a layer of aluminium. Then, the aluminium is coated with a chemically-protective wax. The negative of the electrode pattern is carved in the wax coating with the use of lasers (hence the name of the procedure). Once done, the germanium crystal face is immersed in chemical solution reactive with aluminium. Only the aluminium protected by the wax (patterned as the desired electrode design) is left on the surface. Finally, the wax coating is removed with an other chemical.

Advantages and Inconvenient of the 2 techniques ?
-Mask during evaporation is more precise and quicker but can only be use for simple patterns  with the cylindrical symmetry of the crystal.
-Photolitography is a longer process, and may be less precise (chemical attack of the aluminium?) but can be used for any pattern desired. Useful in the case of square grids.
- Also, some constraints on the minimum width of the electrodes ?

Leakage current exist on the surface of the crystal thanks to possible defects (ref edelweiss?). After depositing the electrodes, the bare germanium surfaces are etched with a XeF2 pulsed beam in vacuum chamber. The surface of the germanium is altered according to the following equation:
$$Ge + 2XeF_2 \longrightarrow GeF_4 + 2Xe$$
The xenon gas is removed and the fluoarated germanium surface is able to hold much higher voltage bias.

Now that the aluminium electrodes were deposited on the germanium crystal, it is possible to proceed with the cabling. The fragility of the germanium and the shallow aluminium layers motivate the use of wire-bonding as cabling technique. 

*description wire-bonding machine*

In the case of simple electrodes (full planar detector), several wires link the top (and bottom) electrodes to a conductive pad on the detector copper chassis. The conductive pad is then cabled to the ionization electronics.
With more complex design (fully interdigitized), wires are used to connect different aluminium patches, essentially imposing the same electric potential is those. With two wire bridges, It is possible to create interleaved electrodes with a biasing scheme based on the co-planar grid technique for event localisation [ref emeline 86], but more on that later.


\subsection{Luke Neganov effect}

When electric charges drift under the influence of the applied electric field in the germanium crystal, phonons are created and eventually participate to the heat signal. This process is called the Luke-Neganov [ref 63 emeline]. This phenomenon happening in semi-conductors is analogous to the Joule Effect present in conductors. 
The drifting electrons constantly dissipate their energy to the phonons bath. As the electrons stay in motion and are eventually collected by the electrodes, the electric field must provide a work $W$ compensating the energy loss going into the heat channel.
This work required for a single electron-hole pair is expressed as:
\begin{align}
W &= q_{e^{-}} \int_{ \vec{r_i} }^{ \vec{r_{e,f}} } \vec{E} d\vec{r} - q_{h^{+}} \int_{ \vec{r_i} }^{ \vec{r_{h,f}} } \vec{E} d\vec{r} \\
&=  -e \int_{ \vec{r_i} }^{ \vec{r_{e,f}} } \frac{\partial V}{\partial \vec{r}} d\vec{r} + e \int_{ \vec{r_i} }^{ \vec{r_{h,f}} } \frac{\partial V}{\partial \vec{r}} d\vec{r} \\
&= e \left( V(\vec{r_{h,f}}) - V(\vec{r_{e,f}}) \right)
\end{align}
where $q_{e^{-}} = e = - q_{h^{+}} $ represent the electric charges and $\vec{r_{i,f}}$ is the final position of the electric charge $i \in \{e^{-}, h^{+}\}$. Therefore, the energy generated by the Luke-Neganov (for a single pair) depends solely on the electric potential at the end of drift positions for the electron $\vec{r_{e,f}}$ and the hole $\vec{r_{h,f}}$.


The Luke-Neganov effect boosts the heat channel by adding a Luke-Neganov energy $E_{Luke-Neganov}$. For a recoil of type $j \in \{ e, n\}$ generating a number of electron-pairs $N^j$, the expression of this energy is:
\begin{equation}
E_{Luke-Neganov} = e \sum_{i=0}^{N^j} \left( V(\vec{r_{h,f}^i}) - V(\vec{r_{e,f}^i}) \right)
\end{equation}
A useful, and mostly accurate, approximation is to consider that all the charges end their drift by being collected at the electrodes polarized at potential $V_+$ and $V_-$. Thus, a simpler expression of the boost in energy is:
\begin{equation}
E_{Luke-Neganov} = N^j e (V_+ - V_-) = N^j e \Delta V
\end{equation}
The Luke-Neganov effect is proportional to the number of pairs $N^j$ created in the ionization process and the voltage bias $\Delta V$ of the detector. Using the equation \ref{eq:number-pairs}, we can express the boost as a function of the recoil energy $E_R$ and the associated quenching factor $Q^j$:
\begin{equation}
E_{Luke-Neganov} = Q^j \frac{E_R}{\epsilon} e \Delta V
\end{equation}
A useful simplification is to consider that $e / {\epsilon} = 1/3 \textsf{V}^{-1}$,  and to have a final expression of the Luke-Neganov boost as:
\begin{equation}
\label{eq:nl-boost}
E_{Luke-Neganov} = Q^j E_R \frac{\Delta V}{3}
\end{equation}
We see that for the same recoil energy $E_R$, an electronic recoil will benefits more than a nuclear recoil from the boost according to the comparison of  their quenching factor $Q^e > Q^n$. This is very important to keep in mind when reconstructing the recoil energy $E_R$ from the measured heat energy $E_{heat}$ as it is a function of the deposited recoil energy $E_R$ and the recoil type $j$:
\begin{align}
E_{heat} (E_R, j ) &= E_{R} + E_{Luke-Neganov} ( E_R, j) \\
&= E_R \left( 1 + Q^j(E_R) \frac{\Delta V}{3} \right)
\end{align}

*more on that now or later ? Kevee, kevnr, use of the Ei and Ec to deduce Q and Er*


\subsection{Shockley–Ramo theorem}

[ref quentin 100 101 102]
The signal induced on the electrodes of a detector does not corresponds to the collection of the drifting charges (when the charges reach the electrodes) but rather corresponds to the induced current starting from the moment the electron-pairs are created by a recoil. Indeed, when a charge is moving in the vicinity of an electrode, it induces an instantaneous electric current by affecting the electrostatic field lines ending on the electrode. 
[wiki after]
The Shockey-Ramo theorem states that the current $i$ induced on a given electrode due to the motion of a charge is given by:
\begin{equation}
I = E_v q v
\end{equation}
where $q$ is the charge of the particle, $v$ its velocity and $E_v$ the component of the electric field in the direction of $v$, under the following conditions: charge removed, given electrode raised to unit potential, and all other conductors grounded. This theorem ensues from Gauss theorem.
This theorem can be integrated to access the induced charge on a given electrode $k$:
\begin{equation}
\label{eq:ramo-theorem-integrated}
Q_k = - q \Phi_k(\vec{r})
\end{equation}
with $\Phi_k(\vec{r})$ the weighted potential of the electrode $k$. This weighted potential is obtained in the same conditions as $E_v$. (figure of such potential for an electrode?).
In the case of a drifting charge $q$ of initial position $\vec{r_{q,i}}$ and final position $\vec{r_{q,f}}$, the total integrated charge induced on the electrode $k$ is:
\begin{equation}
Q_k = q \left( \Phi_k (\vec{r_{q,f}}) - \Phi_k (\vec{r_{q,i}}) \right)
\end{equation}
The Shocley-Ramo theorem benefits from the superposition theorem such that it is possible to express the signal induced by a number $N$ of electron-hole pairs:
\begin{align}
Q_k &= \sum_{n=1}^{N} \left( Q_k^n(e^-) + Q_k^n(h^+) \right) \\
&= \sum_{n=1}^{N} -e \left( \Phi_k^n (\vec{r_{e,f}}) - \Phi_k^n (\vec{r_{e,i}}) \right) +e \left( \Phi_k^n (\vec{r_{h,f}}) - \Phi_k^n (\vec{r_{h,i}}) \right)
\end{align}
When considering the drifting of a single electron-hole pair, the initial position is the same for both charges and thus: $\Phi_k (\vec{r_{e,i}}) = \Phi_k (\vec{r_{h,i}})$.
The signal induced by $N$ electron-hole pairs is simplified to:
\begin{equation}
Q_k = e \sum_{n=1}^{N} \left( \Phi_k^n (\vec{r_{e,f}}) - \Phi_k^n (\vec{r_{h,f}}) \right)
\end{equation}
It solely depends on the weighted potential of the final position of the charges. While the vast majority of charges ends up collected in the electrodes and participate with a weighted potential of $\pm 1$, some charges are trapped and so participate to the signal with the weighted potential corresponding to the position of the trap, which reduces the induced signal.
If the electrodes of the detector form a Faraday cage, all the field lines end on the electrodes and none is leaving the crystal. As a result, when considering a unique charge $q$ in the crystal, the total weighted potential $Q_T$ is:
\begin{equation}
\label{eq:charge-conservation}
Q_T = Q_A + Q_B + Q_C + Q_D = -q
\end{equation}
When considering $N$ electron-holes pairs, the Faraday cage imposes the charge conservation:
\begin{equation}
\label{eq:charge-conservation}
Q_T = Q_A + Q_B + Q_C + Q_D = \sum_{n=1}^{N} e (1 – 1) = 0
\end{equation}

Should I include the study of the trapping by Quentin ? Some studies [103 and 104 quentin ref] were done on the dependance of the electric charge  trapping in germanium crystals. Electrons are more prone to be trapped than hole. According ti Quentin, 10 to 20\% of the carriers are trapped (?). He then calculates the signal induced with trapping and also the effect of trapping as a function of the trap localization. And the impact of trapping on the heat channel.


\subsection{Objective of the electrode study}

Produce a good design of electrodes for 32g/38g ge detectors.

Objectives:
\begin{itemize}
	\item Low capacitance
	\item High fiducial volume
	\item Good charge collection
\end{itemize}

2 Experiments : EDELWEISS and RICOCHET with different operating conditions (underground vs above ground operation, etc..)
\begin{itemize}
	\item EDELWEISS is limited by the radioactive background
	\item RICOCHET is limited by the signal-over-noise ratio
\end{itemize}


\section{Simulation for the design of the Ionization Channel}


\subsection{Introduction to Finite Element Method and Analysis:}

The simulation of the detector is done with the finite element method software COMSOL Multiphysics.
The finite element method (FEM) is the most widely used method for solving problems of engineering in fields such as structural analysis, heat transfer, fluid flow, mass transport, and increasingly more. The domain which is of interest for this work in the solving of electromagnetic potential problems.  The FEM is a particular numerical method for solving the associated partial differential equations in two or three space variables. 
To solve a problem, the FEM subdivides a large system into smaller, simpler parts that are called finite elements. This is achieved by a particular space discretisation in the space dimensions, which is implemented by the construction of a mesh of the object: the numerical domain for the solution, which has a finite number of points. Each finite elemnt is represented by a set of element equations to the original problem. The element equations are simple equations that locally approximate the original complex equations to be studied, where the original equations are often partial differential equations (PDE). The PDE is locally approximated with 
a set of algebraic equations for steady state problems (used in this work)
a set of ordinary differential equations for transient problems (not used in this work)
These equation sets are the element equations. Algebraic equation sets that arise in the steady state problems are solved using numerical linear algebra methods.
The finite element method formulation of a boundary value problem finally results in a system of algebraic equations. The method approximates the unknown function over the domain. The simple equations that model these finite elements are then assembled into a larger system of equations that models the entire problem. The global system of equations has known solution techniques, and can be calculated from the initial values of the original problem to obtain a numerical answer. It uses variational methods from the calculus of variations to approximate a solution by minimizing an associated error function. 
Studying or analyzing a phenomenon with FEM is referred to as finite element analysis (FEA). 
The subdivision of a whole domain into simpler parts has several advantages:
\begin{itemize}
	\item Accurate representation of complex geometry 
	\item Inclusion of dissimilar material properties 
	\item Easy representation of the total solution 
	\item Capture of local effects
\end{itemize}

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/mesh_fid38.png}
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/electric_potential_fid38.png}
\caption{A small geometry, planar condensator. On left is the meshing along with the different element and materials used. On the right is the simple results of the resolution: voltage map with streamlines of the electricfield.
\textbf{Caption Left:} FEM mesh generated by the software prior to finding a solution to an electrostatic system. Two electric terminals in white (one is grounded) are facing each other separated by air in a electric floating  case. Although the geometry may seem simple, it would be very challenging to calculate the magnetic field for this setup without FEM software, using equations alone. (due to edge effects.)
\textbf{Caption Right:} FEM solution to the problem. The top and bottom electrode have electric potentials of 1V and 0V respectively. The color represents the electric potential in the air surrounding the electrodes.  The black lines represents the streamlines of the electric field in the air.  As the case is electrically floating, no streamlines can penetrate the case. We see the usual uniform electric field of a planar capacitor between the electrodes while outside the separation, the electric field is warped as it is subject to edge effects.
}
\label{fig:fid38-mesh}
\end{figure}


\subsection{Choice of the Space Dimension}

The geometry I am building. The geometry can be built in 2D-axisymmetri or 3D. A justification is needed to show that 2D is good enough for the study. Because the calculation are much quicker with it and better for a quick modelization.
The Comsol software propose several choices of space dimension for the modelization. The most evident would be to work with a 3D model of the detectors. However, it is possible to benefit from the natural cylindrical symmetry of the detectors in this study to ease the calculation. Indeed, solving the electric equations on the whole volume would be redundant as it can be done a radial slice of the detector and then revolved around its central axis. Working with this radial slice of a system is using a space dimension called the 2D-axisymmetry in COMSOL.

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/geometry_2d.png}
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/detector_3d.png}
\caption{
A geometry in 2D-axisymmetry and in 3D. On the left, the geometry is built on a plane (in two dimensions) and around the axis of symmetry situated at r=0. The germanium crystal (inner rectangle) is equipped with electrodes on each planar face, and is installed is a copper chassis (outer ractangle) where the air was vaccumed.
The same geometry can be obtained with a 3D modelization, without taking into account the symmetry of the system. As a result, a more complex meshing is needed to solve the problem which translate to a longer calculation time. However, it is possible to add non-symmetric features such as non-centered rectangular NTD, or the wire-bonding bridge between the electrodes (not featured in this study). 
}
\label{fig:fid38-mesh-potential}
\end{figure}

The figure [fig] presents the modelization of a the same detector using both space dimension. It was checked (justification needed) that both space dimension result in the same solutions. (variations between the two are negligible). The advantage of the 2D-axisymmetry lies in the solving of the electric equations in a 2D plane with pertinent variable changes to consider the axisymmetry. This needs for a simple 2D meshing. On the contrary the 3D modelization do not benefit from the symmetry and solve the equations in the whole volume. This requires a more complex meshing with more vertexes (number?). The calculation time is therefore longer. However, when adding non-symmetrical features to the system, the 3D modelization is the only way to solve the equations with a precise geometry. Non-symmetrical features can be the NTD thermal sensor, the wire-bond bridge cabling the electrodes or even the Teflon pad fixing in place the germanium crystal in the copper chassis.
As this work aims at studying multplie geometry by scanning over different parameters, the 2D-axisymmetry was chosen in order to have short calculation times. The 3D might be used specifically to determine the influence of additionnal features. (Bonus study if time ?)


\subsection{Meshing choice}

When solving a problem with the finite element method, the choice of the meshing is essential. As the FEM is essentially approximating the analytical solution with a numerical approach over the vertexes, the meshing should be well constructed to assure a precise simulation. For a given physic system, the analytical solution can be more precisely approximate as the number of vertexes is increased. However, a high number of vertexes induces an equal number of local numerical solving. COMSOL propose a automatic optimization of the meshing which adapts the size of meshing to the geometry of the system. With this optimized meshing, there are a lot of vertexes near small geometric features assuring that a rapidly varying electric field is correctly mapped. At the same time, there are only few vertexes at location where the electric field is almost uniform. This optimization of the meshing is possible with the “Physics-based” option of COMSOL which still accept a global scale parameter. [ref to table with global mesh scale]

{\color{red}TABLE PLACEHOLDER}
%Table with the scale parameter: [Very coarse to Normal to Extremely fine] + statistics of the meshing, and maybe some illustrating images. Ligne pour la capcitance du condesatuer plan (avec reference analytique) et ligne pour le FID38 avec pour reference la maille la plus fine.

We want to simulate the detectors with enough precision while having acceptable solving times. A well-known electrostatic system with a known analytical solution is constructed and serve as a reference. The numerical solution obtained with the FEM is checked and compared with the analytical solution for different global meshing scales. This chosen system is the planar capacitor without edge effects. The associated analytical solution is known and the electric capacitance $C$ is expressed as:

\begin{equation}
C = \epsilon_0 \epsilon_r \frac{A}{d}
\label{eq:planar-capacitor}
\end{equation}

With $\epsilon_r$ is the relative permittivity, $A$ the area of the electrodes and $d$ the distance separating the electrodes. The figures [fig capa vs Area] and figure [fig capa vs Distance] shows the analytical value of the capacitance in function of the area of the electrodes and the distance of separation, respectively. The different curves represents the single analytical solution and the multiple numerical solution with a scan on the mesh scale. The FEM solution clearly succeed in simulating the planar capacitor with its capacitance being proportional to the area of the electrodes and inversely proportional to the separation distance. 
Some sentences about the discrepancies between the analytical and the numerical solutions. And which mesh scale is chosen for this thesis.

{\color{red}PLACEHOLDER: GRAPH PLANAR CAPACITOR}
%Figure of the Capacitance vs Area (Analytical vs Numerical COMSOL)
%Figure of the Capacitance vs the Distance between the electrode (Analytical vs Numerical COMSOL)


\subsection{Modelization of a RED detector}

This work aims at discovering and quantifying the impact of the design of the electrodes upon the ionization channel performance. Multiple geometries were simulated with common parameters and sometimes their own specific parameters. As a result, the study of the common parameters is illustrated with a reference electrode geometry “FID38”, and the impact of specific parameters are discussed with their associated geometry.
The “FID38” geometry stands for a detector composed of a 38g germanium crystal with Fully InterDigitized (FID) electrodes. The absorber is simulated as a cylinder of height 10mm and radius 15mm composed of germanium crystal of relative electric permittivity 16.3. It is surrounded by a cylindrical copper chassis leaving a distance $d_{chassis}=3mm$ between the chassis and the surface of the absorber. The copper chassis is electrically grounded at a potential $V_chassis=0V$. It is assumed that the influence of the Teflon clamps holding the absorber is negligible considering their size and the low relative electric permittivity of the material ($epsilon_r=2.1$). As such, Teflon clamps are ignored in the simulation. The space between the germanium crystal and the copper chassis is considered to be vacuum of relative permittivity 1. The electrodes are simulated by extruded annuli, resembling thin rings, composed of aluminium of height $h_{Al}=0.01[mm]$ and width $w_{Al}=0.08mm$. Real electrodes possess a much lower height of about 50nm. However, this value is so low that the meshing is invariably messed up. For a FID geometry, there are 4 electrodes labeled ‘A’, ‘B’ ‘C’, and ‘D’ composed of multiple rings linked by wire-bound bridges. Inside COMSOL, multiple electrodes can be assigned to the same electric terminal, which means that they are electrically linked and share their potential and charges. It is therefore possible to avoid the simulation of the wire-bonding bridges between the different FID rings. (at least for now, see later in bonus study if it is really impacting something). Each physical electrodes ‘A’, ‘B’, ‘C’, ‘D’ represented by terminals in COMSOL are polarized at a fixed voltage $V_i \, \textsf{with} \, i \in {A,B,C,D}$. The terminals ‘B’ and ‘D’ corresponds to the main electrodes, labeled “Collect”, which collect the electric charges produced in the bulk of the detector. The terminal ‘A’ and ‘C’ corresponds to auxiliary electrodes, labeled “Veto”, which collect the charges produces near the surface of the absorber. The polarization of the electrodes is controlled by three parameters :
\begin{itemize}
	\item $V_{bias}=8V$, which is the main voltage bias of the detectors
	\item $R_{veto}=-0.25$, which is the ratio of the voltage bias of the veto electrodes over the main voltage bias
	\item $S_{bias}=0.5$, varying between 0 and 1, it represents the vertical symmetry of the polarization.
\end{itemize}
With this three parameters, the fixed voltage of the terminals are:
\begin{align}
V_B &= V_{bias} \times S_{bias} = 4V \\
V_D &= - V_{bias} \times (1 - S_{bias}) = -4V \\
V_A &= V_{bias} \times (1 - S_{bias}) \times R_{veto} = -1V \\
V_C &= - V_{bias} \times S_{bias} \times R_veto = 1V
\end{align}

Several parameters govern the location of the ring-shaped electrodes on the top and the lateral surface of the absorber. The number of total concentric electrodes on the top (resp. lateral) surface is $n_{top}=7$ (resp. $n_{lateral}=2$). The distance separating the center of each top (resp. lateral) electrode is $d_{Al}^{top}=2.395mm$ (resp. $d_{Al}^{lateral}=1.98mm$). The innermost and outermost top electrodes are assigned to the veto terminals ‘A’ or ‘C’. The radius of the innermost electrode is $r_{inner}=0.25mm$. The radius of the outermost is limited to the radius of the germanium crystal minus a band of width $r_{edge}=0.3mm$. This comes from the limits of the aluminium deposition technique employed: it is not possible to have a thin aluminium electrode at less than $0.3mm$ from the edge of the top surface of the germanium crystal. The two most centered lateral electrodes are also assigned to the veto Terminals ‘A’ and ‘C’. These electrodes are distant from the equatorial line of the crystal by $d_{equatorial}=1mm$.

\begin{figure}
\centering
\includegraphics[height=5cm]{Figures/Electrodes/scheme_fid38.pdf}
\caption{
Scheme of the fid38, with annotated electrodes (ANNOTATION ARE MISSING)
}
\label{fig:fid38-scheme}
\end{figure}

The electric equations are solved only in the insulators domains : the germanium absorber and the surrounding vacuum inside the copper chassis. The aluminium electrodes are set to a fixed potential and their interior is excluded from the simulation. 

\begin{table}[]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{lcr}
Parameter                                   & Symbol        & Default Value \\ \hline \hline
Ge crystal Height                           & $H_{Ge}$      & 10{[}mm{]}    \\
Ge crystal Radius                           & $R_{Ge}$      & 15{[}mm{]}    \\
Distance between crystal and copper chassis & $D_{Cu}$      & 3{[}mm{]}     \\
Electrode Thickness                         & $h_{Al}$      & 0.01{[}mm{]}  \\
Electrode Width                             & $w_{Al}$      & 0.08{[}mm{]}  \\
Radius of the innermost planar electrode    & $r_{inner}$   & 0.25{[}mm{]}  \\
Distance between the outermost planar electrode and the edge of the crystal      & $d_{edge}$    & 0.3{[}mm{]} \\
Number of planar electrodes                 & $n_{planar}$  & 7             \\
Number of lateral electrodes                & $n_{lateral}$ & 2             \\
Interdistance of Planar electrodes          & $d_{planar}$  & 1.98{[}mm{]}  \\
Interdistance of Lateral electrodes         & $d_{lateral}$ & 2.03{[}mm{]}  \\
Distance between the centermost lateral electrode and the equator of the crystal & $d_{equator}$ & 1{[}mm{]}   \\
Main Voltage Bias                           & $V_{bias}$    & 8{[}V{]}      \\
Ratio Veto/Main voltage bias                & $R_{veto}$    & -0.25         \\
Symmetric factor of the voltage bias        & $S_{bias}$    & 0.5         
\end{tabular}
}%
\caption{List and Value of the default parameters for FID38}
\label{tab:fid38-default-parameters}
\end{table}

\subsection{Stationnary Study}

The stationary study consists in solving the electrostatic equations for the given parameters and voltage bias. The FEM solution consists in the electric potential value for each vertex of the mesh. This values are interpolated and used to represent the potential on a radial slice of the detector (as seen in figure [fig potential]). It is possible to apply a gradient function to obtain the electric field in the detector (as seen in figure [fig enorm]) along with the streamline of the electric field. The streamlines are useful to visualize the direction of the electric field in the crystal and predict the trajectory of the drifting charges in the detector.


{\color{blue} Discussion on the Electric potential needed here.}

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/electric_field_norm.png}
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/hist_enorm.png}
\caption{
\textbf{Left:} Graph of the norm of the electric field in the detector with streamlines.
\textbf{Right:} Density Histogram of the electric field norm value in the partitioned volume of the Ge crystal.(need image annotation, on the different peak in particular)
}
\label{fig:fid38-enorm}
\end{figure}

{\color{blue} Discussion on the Electric field norm needed here.}

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/fid38_fiducial_streamlines.png}
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/fid38_fiducial_contour.png}
\caption{
\textbf{Left:} Graph of the electric potential with fiducial streamlines in FID38.
\textbf{Right:} Total(red) and Fiducial(green) volume contours after processing of the streamlines crossing z=0. Compared to the original graph on the left, the streamlines are stretched towards the exterior of the cylindrical Ge crystal according to a linear scaling with the radius of the point. This scaling emulates the volume of a cylinder in a 2D plan.
}
\label{fig:fid38-fiducial}
\end{figure}

{\color{blue} Discussion on the fiducial streamlines needed here.}

\subsection{Weighted Potential Study}

This paragraph is linked to a previous one introducing the signal generation on the electrodes by drifting electric charges with the Shockley-Ramo theorem. A map of the weighted potential associated to each electrode is obtained by fixing the potential of the considered electrode to the unitary value of 1V and grounding all the other terminals. (see left of  figure [Weighted potential]). The total weighted potential is obtained by summing over the different electrodes. (see left of  figure [Weighted potential]).

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/weighted_potential_collect.png}
\includegraphics[width=0.48\textwidth]{Figures/Electrodes/weighted_potential_total.png}

\includegraphics[width=0.48\textwidth]{Figures/Electrodes/ramo_potential.png}
\caption{
\textbf{Top Left:} Graph of the weighting potential for the main top collect electrode.
\textbf{Top Right:} Graph of the total weighting potential. It corresponds to the sum of the weighting potential of all the electrodes.
\textbf{Bottom Center:} Graph of the weighting potential of different electrodes as a function of the position in the crystal.
}
\label{fig:weighting-potential}
\end{figure}

While the red color indicate a total weighted potential $\phi_T$ which tends to 1, the color blue is associated to an inferior total weighted potential. We see that the potential is almost uniform in the bulk of the crystal while it is increasing near the electrodes. According to the Shockley-Ramo theorem, electron-holes pairs created very near an electrode are inducing a signal almost entirely in the A,B,C,D electrode. However, for pairs created in the bulk of the crystal, a fraction (1-0.96=0.04=4\%) of the signal is induced in the copper chassis outside of the crystal. As a result, the detector is not a perfect Faraday Cage, but is approaching its properties as the minimum total weighted potential in the crystal is 0.94.  

{ color{blue} Discussion on the loss of energy in the case of trapping as a result of a total weighted potential inferior to 1. Rough estimation of the limit on the intrinsic resolution of the ionization resolution for several fraction of trapping per recoil.}


\subsection{Capacitance calculation with the Source Sweep Study}

The sensitivity of the ionization channel is inversely proportional to the capacitance of the electrodes. Therefore, the capacitance is a performance indicator for the different design of electrodes.
The common form of a capacitance is a parallel-plate capacitor: two conductive plates separated by a dielectric material of relative electric permittivity $\epsilon_r$. For the ideal case of this system, the capacitance $C$ is proportional to the surface area of the electrodes $A$ and inversely proportional to the distance between the terminals $d$ such that:
\begin{equation}
C = \epsilon_0 \epsilon_r \frac{A}{d}
\end{equation}
For this system composed of only two electrodes, the capacitance $C$ governs the amount of electric charges on the plates $Q$ and $-Q$ necessary to impose a voltage $V$ between them according to the equation:
 \begin{equation}
 \label{eq:capacitance-definition-simple}
C = \frac{Q}{V}
\end{equation}
In the case of germanium bolometers, the capacitance is more complex as it takes into accounts the grounded copper chassis, two main collecting electrodes and, depending on the considered design, two auxiliary electrodes (guard or veto). The previous equation does not apply in system with more than two terminals and should be generalized to any electric system with a number $N$ of electrodes. For such a system, the charge and electric potential of all the electrodes are represented by the the charge vector $\vec{Q}$ and the potential vector $\vec{V}$ as:

\begin{equation} 
\label{eq:vector-charge-potential}
\vec{Q} = 
\begin{pmatrix}
Q_{1} \\ 
Q_{2} \\ 
\vdots \\ 
Q_{N}
\end{pmatrix} 
\quad \textsf{and} \quad
\vec{V} = 
\begin{pmatrix}
V_{1} \\ 
V_{2} \\ 
\vdots \\
V_{N}
\end{pmatrix} 
\end{equation}

In order to generalize the calculation of the capacitance to the electrodes of the bolometer, the concept of Maxwell capacitance matrix $\bm{C}$ is introduced:

\begin{equation} 
\label{eq:maxwell-capacitance-matrix}
\bm{C} = 
\begin{pmatrix}
C_{11} & C_{12} & \cdots & C_{1N} \\ 
C_{21} & C_{22} & \cdots & C_{2N} \\ 
\vdots & \vdots & \ddots & \vdots \\ 
C_{N1} & C_{N2} & \cdots & C_{NN}
\end{pmatrix}
\quad \textsf{with} \quad
\bm{C}_{ij} = \frac{\partial Q_i}{\partial V_j}
\end{equation}

This matrix describes the relation between the charge $Q_i$ and the voltage $V_i$ of all the conductors in the system, and generalize the \ref{eq:capacitance-definition-simple} as:

\begin{equation} 
\label{eq:capacitance-definition-matrix}
\vec{Q} =
\bm{C} \vec{V}
\quad \Leftrightarrow \quad
\vec{V} =
\bm{C}^{-1} \vec{Q} = \bm{P} \vec{Q}
\end{equation}
with $\bm{P}$ being the inverse of the Maxwell capacitance matrix named the elastance matrix. Its terms $\bm{P}_{ij}$ are called the coefficients of potential such that:
\begin{equation}
\label{eq:elastance-matrix}
\bm{P} =
\begin{pmatrix}
P_{11} & P_{12} & \cdots & P_{1N} \\ 
P_{21} & P_{22} & \cdots & P_{2N} \\ 
\vdots & \vdots & \ddots & \vdots \\ 
P_{N1} & P_{N2} & \cdots & P_{NN}
\end{pmatrix}
\quad \textsf{with} \quad
\bm{P}_{ij} = \frac{\partial V_i}{\partial Q_j}
\end{equation}
It was demonstrated [ref?] that the coefficients of potential are symmetrical such that  $\bm{P}_{ij} = \bm{P}_{ji}$ which induces that the Maxwell capacitance matrix is symmetric as well.

While the Maxwell capacitance matrix is useful to study the generation of signal from charge collected by the electrodes with the equation \ref{eq:capacitance-definition-matrix}, there are no readily available interpretation for its term. An alternative to the Maxwell capacitance matrix is the mutual capacitance matrix $\bm{C}^m$. This terms of the mutual capacitance terms hold the benefit of being easily illustrated as lumped capacitance between the electrodes of a system. The figure [scheme mutual capacitance] presents a scheme of the four electrodes of the FID38 design in the grounded copper chassis.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Figures/Electrodes/lumped_capacitance_scheme.png}
\caption{Scheme representing the terms of the Mutual capacitance matrix. FEATURE THE MUTUAL CAPACITANCE MATRIX PLIZ}
\label{fig:lumped-capacitance}
\end{figure}

Each term $\bm{C}_{ij}^m$ can be interpreted as a lumped capacitance between two electrodes $i$ and $j$ and as such, are represented with the common parallel-plate capacitor symbol. One can note that the diagonal mutual capacitance terms $\bm{C}_{ii}^m$ are interpreted as the capacitance between the electrode $i$ and the ground (here the copper chassis). It is important to note that this matrix does not represent the relation between the electric charge $\vec{Q}$ and potential $\vec{V}$ of the electrodes of the system and therefore the equation \ref{eq:capacitance-definition-matrix} cannot be applied with the mutual capacitance matrix. Instead, the mutual capacitance matrix should be used as a modelization and interpretation tool. It is possible to obtain the Maxwell capacitance matrix from the mutual capacitance matrix according to:

\begin{equation} 
\label{eq:mutual-to-maxwell}
\bm{C} = 
\begin{pmatrix}
C_{11} & C_{12} & \cdots & C_{1N} \\ 
C_{21} & C_{22} & \cdots & C_{2N} \\ 
\vdots & \vdots & \ddots & \vdots \\ 
C_{N1} & C_{N2} & \cdots & C_{NN}
\end{pmatrix}
 = 
\begin{pmatrix}
\sum_{j=1}^N C_{1j}^m & -C_{12}^m & \cdots & C_{1N}^m \\[0.3em]
-C_{21}^m & \sum_{j=1}^N C_{2j}^m & \cdots & C_{2N}^m \\[0.3em]
\vdots & \vdots & \ddots & \vdots \\[0.3em] 
C_{N1}^m & C_{N2}^m & \cdots & \sum_{j=1}^N C_{Nj}^m
\end{pmatrix}
\end{equation}

With the interpretation of the mutual matrix as lumped capacitances, we see that the diagonal terms $\bm{C}_{ii}$ of the Maxwell capacitance matrix are simply the equivalent capacitance to all the lumped mutual capacitance $\bm{C}_{ij}$ put in parallel $C_{ii} = \sum_{j=1}^N C_{ij}^m$. As the non-diagonal terms of the Maxwell and the mutual capacitance matrix are opposite, the mutual capacitance matrix is also symmetric.

COMSOL offers a functionality called Stationary Source Sweep to evaluate the elastance and the capacitance matrices. Considering the equation \ref{eq:elastance-matrix}, a terminal $j$ is excited with an electric charge $Q_j$ with the charges of all the other terminals are set to $Q_i=0 , i!=j$. The electrostatic system is numerically solved and the coefficient of potential can be deduced from the electric potential of the terminals $V_i$:
\begin{equation}
\bm{P_{ij}} = \frac{V_i}{Q_j}
\end{equation}
This procedure is repeated for each terminal until the full elastance matrix $\bm{P}$ is evaluated. Using the equations \ref{eq:maxwell-capacitance-matrix} and \ref{eq:mutual-to-maxwell}, the capacitance matrices can also be evaluated. In order to facilitate the discussion, the indexes of the matrices are swapped with the label of the electrodes as: $$\{A,B,C,D\} = \{1,2,3,4\}$$
In the case of the FID38 design with default parameters, all these matrices are :

\begin{equation} 
\label{eq:fid38-matrix-evaluation}
\begin{array}{rrccclc}
 & \bm{P} = &
 \begin{pmatrix}
P_{AA} & P_{AB} & P_{AC} & P_{AD} \\ 
P_{BA} & P_{BB} & P_{BC} & P_{BD} \\ 
P_{CA} & P_{CB} & P_{CC} & P_{CD} \\ 
P_{DA} & P_{DB} & P_{DC} & P_{DD}
\end{pmatrix}
&=&
\begin{pmatrix}
2.23 & 1.92 & 1.71 & 1.69 \\
1.92 & 2.34 & 1.69 & 1.68 \\
1.71 & 1.69 & 2.23 & 1.92 \\
1.69 & 1.68 & 1.92 & 2.34 \\
\end{pmatrix}
& \cdot 10^{11} & [\textsf{F}^{-1}] \\
\Rightarrow & \bm{C} = &
\begin{pmatrix}
C_{AA} & C_{AB} & C_{AC} & C_{AD} \\ 
C_{BA} & C_{BB} & C_{BC} & C_{BD} \\ 
C_{CA} & C_{CB} & C_{CC} & C_{CD} \\ 
C_{DA} & C_{DB} & C_{DC} & C_{DD}
\end{pmatrix}
&=&
\begin{pmatrix}
18.25 & -10.19 & -4.02 & -2.58 \\
-10.19 & 15.94 & -2.58 & -1.98 \\
-4.02 & -2.58 & 18.25 & -10.19 \\
-2.58 & -1.98 & -10.19 & 15.94 \\
\end{pmatrix}
& \cdot 10^{-12} & [\textsf{F}] \\
\Rightarrow & \bm{C}^m = &
\begin{pmatrix}
C_{AA}^m & C_{AB}^m & C_{AC}^m & C_{AD}^m \\ 
C_{BA}^m & C_{BB}^m & C_{BC}^m & C_{BD}^m \\ 
C_{CA}^m & C_{CB}^m & C_{CC}^m & C_{CD}^m \\ 
C_{DA}^m & C_{DB}^m & C_{DC}^m & C_{DD}^m
\end{pmatrix}
&=&
\begin{pmatrix}
1.46 & 10.19 & 4.02 & 2.58 \\
10.19 & 1.18 & 2.58 & 1.98 \\
4.02 & 2.58 & 1.46 & 10.19 \\
2.58 & 1.98 & 10.19 & 1.18 \\
\end{pmatrix}
& \cdot 10^{-12} & [\textsf{F}]
\end{array}
\end{equation}

{ \color{blue} 
Discussion on the matrix evaluation (this logical, blablabla).
}

\subsection{Sensitivity and Figure of Merits}

{\color{red} Lot of calculus ahead. Not formatted for manuscript !}

In the case of the FID38, we try to model the generation of the ionization signal. We consider an ideal detector with default parameters (A,B,C,D = -1,+4,+1,-4 V) with no trapping and a single electron-hole pair created at a desired location. We assume that the electric charges will drift following exactly the electric field lines. The disposition of the electrodes for the FID38 design illustrated in the scheme \ref{fig:fid38-scheme} mentions four possible locations for the recoils to happen. Each location will have charges drifting towards a specific combination of electrodes inducing an electric charge perturbation $\vec{q}$ according to the integration of the Shockley-Ramo theorem \ref{eq:ramo-theorem-integrated}. The electric potential signal $\vec{v}$ created by the electric charge perturbation $\vec{q}$ with the application of the equation \ref{eq:capacitance-definition-matrix} along with the evaluation of the Maxwell capacitance matrix \ref{eq:fid38-matrix-evaluation}. The different case of ionization signal generation are:
\begin{itemize}
	\item Bulk events, electron to B, hole to D \begin{equation}
	\Rightarrow \vec{q} =
	\begin{bmatrix}
	0 \\ -1 \\ 0 \\ 1
	\end{bmatrix}
	\cdot e
	\quad \Rightarrow \quad
	\vec{v} = \bm{P} \vec{q} =
	\begin{bmatrix}
	1.92 \\ 2.34 \\ 1.69 \\ 1.68
	\end{bmatrix}
	\cdot (-e)
	+ 
	\begin{bmatrix}
	1.69 \\ 1.68 \\ 1.92 \\ 2.34
	\end{bmatrix}
	\cdot e
	= 
	\begin{bmatrix}
	-0.23 \\ -0.66 \\ 0.23 \\ 0.66
	\end{bmatrix}
	\cdot e \cdot 10^{11}
	\end{equation}
	\item Top Veto events, electron to B, hole to A \begin{equation}
	\Leftrightarrow \vec{q} =
	\begin{bmatrix}
	1 \\ -1 \\ 0 \\ 0
	\end{bmatrix}
	\cdot e
	\quad \Rightarrow \quad
	\vec{v} = \bm{P} \vec{q} =
	\begin{bmatrix}
	2.23 \\ 1.92 \\ 1.71 \\ 1.69
	\end{bmatrix}
	\cdot e
	+
	\begin{bmatrix}
	1.92 \\ 2.34 \\ 1.69 \\ 1.68
	\end{bmatrix}
	\cdot (-e)
	= 
	\begin{bmatrix}
	0.31 \\ -0.42 \\ 0.02 \\ 0.01
	\end{bmatrix}
	\cdot e \cdot 10^{11}
	\end{equation}
	\item Bottom Veto events, electron to C, hole to D \begin{equation}
	\Leftrightarrow \vec{q} =
	\begin{bmatrix}
	0 \\ 0 \\ -1 \\ 1
	\end{bmatrix}
	\cdot e
	\quad \Rightarrow \quad
	\vec{v} = \bm{P} \vec{q} =
	\begin{bmatrix}
	1.71 \\ 1.69 \\ 2.23 \\ 1.92
	\end{bmatrix}
	\cdot (-e)
	+
	\begin{bmatrix}
	1.69 \\ 1.68 \\ 1.92 \\ 2.34
	\end{bmatrix}
	\cdot e
	= 
	\begin{bmatrix}
	-0.02 \\ -0.01 \\ -0.31 \\ 0.42
	\end{bmatrix}
	\cdot e \cdot 10^{11}
	\end{equation}
	\item Equatorial events, electron to C, hole to A \begin{equation}
	\Leftrightarrow \vec{q} =
	\begin{bmatrix}
	1 \\ 0 \\ -1 \\ 0
	\end{bmatrix}
	\cdot e
	\quad \Rightarrow \quad
	\vec{v} = \bm{P} \vec{q} =
	\begin{bmatrix}
	2.23 \\ 1.92 \\ 1.71 \\ 1.69
	\end{bmatrix}
	\cdot e
	+	
	\begin{bmatrix}
	1.71 \\ 1.69 \\ 2.23 \\ 1.92
	\end{bmatrix}
	\cdot (-e)
	= 
	\begin{bmatrix}
	0.52 \\ 0.23 \\ -0.52 \\ -0.23
	\end{bmatrix}
	\cdot e \cdot 10^{11}
	\end{equation}
\end{itemize} 

The first thing one can note is that even though for each case the electron and hole were collected by two electrode, an electric potential perturbation was created on all the electrodes. This phenomenon is referred as "capacitive cross-talk". Then, we note that the amplitude of the signal, referred as "electrode sensitivity" $S_{type}^{A} = |\vec{v}/e|$ is not equal among the collecting electrodes comparing different events. We can quantify this cross-talk by calculating the ratio $X_{type}$ between the signal induced on a non-collecting electrode over the signal induced on a collecting electrode:

\begin{equation}
\begin{array}{cc}
X_{bulk} = \frac{-0.23}{-0.66} = 0.35 & S_{bulk}^{B} = S_{bulk}^{D} = 0.66 \cdot 10^{11}
\\
X_{veto,top} = \frac{0.02}{0.31} = 0.06 & S_{veto,top}^{B} = 0.42 \cdot 10^{11} \quad S_{veto,top}^{A} = 0.31 \cdot 10^{11}
\\
X_{veto,bottom} = \frac{-0.02}{-0.31} = 0.06 & S_{veto,bottom}^{D} = 0.42 \cdot 10^{11} \quad S_{veto,bottom}^{C} = 0.31 \cdot 10^{11}
\\
X_{equator} = \frac{0.23}{0.52} = 0.44 & S_{equator}^{A} = S_{equator}^{C} = 0.52 \cdot 10^{11}
\end{array}
\end{equation}

We can compare the FID38 design "efficiency" by comparing the Maxwell capacitance matrix to a reference ideal planar capacitance $C_{ref}(type, A)$ of the same sensitivity that the considered recoil $type$ and electrode $A$. This reference capacitance is composed of a ground and a unique terminal such that the charge perturbation is $q_{ref}=-e$ and the induced electric potential $v_{ref}(type)$ is expressed as:

\begin{align}
v_{ref}(type, A) &= C_{ref}(type, A)^{-1} \cdot q_{ref} = C_{ref}(type, A)^{-1} \cdot e
\\ \Rightarrow \quad
C_{ref}(type,A) &= \frac{e}{v_{ref}(type,A)} = S_{ref}(type, A)^{-1} = (S_{type}^A)^{-1}
\end{align}

With this definition of the reference capacitance, we can evaluate its value in all the cases:

\begin{equation}
\begin{array}{llr}
C_{ref}(bulk, B) &= C_{ref}(bulk, D) &= 15.2 [\textsf{pF}] \\
C_{ref}(veto top, A) &= C_{ref}(veto bottom, C) &= 32.3 [\textsf{pF}] \\
C_{ref}(veto top, B) &= C_{ref}(veto bottom, D) &= 23.8 [\textsf{pF}] \\
C_{ref}(equator, A) &= C_{ref}(equator, C) &= 19.2 [\textsf{pF}] \\
\end{array}
\end{equation}

We can also compare the FID38 sensitivity to the naive method of ionization sensitivity considering that the reference sensitivity $S_{ref}(type, A)$ of an electrode $A$ is the voltage across a capacitance of value $C_{AA}$ for an accumulation of a unitary charge by using the equation \ref{eq:capacitance-definition-simple} (this is what EDELWEISS and HEMT alex is doing). In this case, the expected sensitivity are:

\begin{equation}
\begin{array}{llr}
S_{ref}(type, B) &= S_{ref}(type, D) &= 0.55 \cdot 10^{11} [\textsf{F}^{-1}] \\
S_{ref}(type, A) &= C_{ref}(type, C) &= 0.63 \cdot 10^{11} [\textsf{F}^{-1}]
\end{array}
\end{equation}

What is the error than was done until now on the sensitivity, you ask ? Well, it is:

\begin{equation}
\begin{array}{llr}
E_(bulk, B) &= E(bulk, D) &= \frac{0.55-0.66}{0.66} = -17\% \\
E_(veto top, B) &= E_(veto bottom, D) &= \frac{0.55-0.42}{0.42} = +31\% \\
E_(veto top, A) &= E_(veto bottom, C) &= \frac{0.63-0.31}{0.31} = +103\% \\
E_(equator, A) &= E_(equator, C) &= \frac{0.63-0.52}{0.52} = +21\%
\end{array}
\end{equation}

It seems like for the moment, we are underestimating the resolution of the main collecting electrode B,D in the case of bulk recoils. However, we are overestimating the sensitivity in the case of the auxiliary electrode A,C and the other type of recoil. Maybe, this will all be absorbed with the correct calculation of the noises for the computation of the resolution.

There is a specific cross-talk and sensitivity for each type of events. When analyzing the detector data, there should therefore be a specific calibration and cross-talk correction associated to each of this type of signal.
However, to this day, the EDELWEISS and R\&D experiments have only use a single analysis pipeline with a single calibration value for each electrodes and a single cross-talk correction matrix, independently of the type of event. Furthermore, the analysis seemed valid and no significant deviation was observed from the simple, yet wrong, ionization model where events creating the same amounts of electron-hole pairs presents the same electrode sensitivity and capacitive cross-talk. This can be explained by the fact that the capacitances of the detector are dominated by the greater capacitance of the cabling. It is important to recall that this work is focused on the capacitance of the electrodes of a detector, and did not considered the capacitance of the cabling between the electrodes and the amplifying electronics. In the experimental setup, the electrodes are cabled to the electronics with coaxial cables. While a coaxial cable shield the signal from the exterior interferences, it also create a significant capacitive coupling between the ground and the core (in this case, the electrode). Let's assume a of $50$pF capacitance between the ground and each electrodes, the elastance matrix is now evaluated to:

\begin{equation}
\bm{C}^{cabling} = \bm{C} + \mathbb{1} \cdot 50 \cdot 10^{-12} [\textsf{F}]
\quad \Rightarrow \quad
\bm{P}^{cabling} = 
\begin{bmatrix}
  0.15 & 0.02 & 0.01 & 0.01\\
  0.02 & 0.16 & 0.01 & 0.01\\
  0.01 & 0.01 & 0.15 & 0.02\\
  0.01 & 0.01 & 0.02 & 0.16\\
\end{bmatrix}
\cdot 10^{11}
\end{equation}

The electric charge perturbations $\vec{q}$ induces in this case the electric potential signal:

\begin{equation}
\begin{array}{rcl}
\vec{v}_{bulk} =& \bm{P}^{cabling} \cdot \vec{q}_{bulk} &= 
\begin{bmatrix}
-0.01 \\ -0.15 \\ 0.01 \\ 0.15
\end{bmatrix}
\cdot e \cdot 10^{11}
\\
\vec{v}_{veto,top} =& \bm{P}^{cabling} \cdot \vec{q}_{veto,top} &= 
\begin{bmatrix}
0.13 \\ -0.14 \\ 0 \\ 0
\end{bmatrix}
\cdot e \cdot 10^{11}
\\
\vec{v}_{veto,bottom} =& \bm{P}^{cabling} \cdot \vec{q}_{veto,bottom} &= 
\begin{bmatrix}
0 \\ 0 \\ -0.13 \\ 0.14
\end{bmatrix}
\cdot e \cdot 10^{11}
\\
\vec{v}_{equator} =& \bm{P}^{cabling} \cdot \vec{q}_{equator} &= 
\begin{bmatrix}
0.14 \\ 0.01 \\ -0.14 \\ -0.01
\end{bmatrix}
\cdot e \cdot 10^{11}
\end{array}
\end{equation}

The cross-talk ratio and electrode sensitivity are now:

\begin{equation}
\begin{array}{cc}
X_{bulk} = \frac{-0.01}{-0.15} = 0.07 & S_{bulk}^{B} = S_{bulk}^{D} = 0.15 \cdot e \cdot 10^{11}
\\
X_{veto,top} = \frac{0}{0.13} = 0 & S_{veto,top}^{B} = 0.14 \cdot e \cdot 10^{11} \quad S_{veto,top}^{A} = 0.13 \cdot e \cdot 10^{11}
\\
X_{veto,bottom} = \frac{0}{0.13} = 0 & S_{veto,bottom}^{D} = 0.14 \cdot e \cdot 10^{11} \quad S_{veto,bottom}^{C} = 0.13 \cdot e \cdot 10^{11}
\\
X_{equator} = \frac{0.01}{0.14} = 0.07 & S_{equator}^{A} = S_{equator}^{C} = 0.14 \cdot e \cdot 10^{11}
\end{array}
\end{equation}

We see that by adding the capacitance of the cabling, the cross-talk phenomenon is significantly lessened and that the electrode sensitivities are very close to 0.14 in absolute value for all the types of events. The small variation of cross-talk and sensitivities were surely "absorbed" in the resolution of the ionization channel in the previous EDELWEISS and IP2I R\&D analysis, leading to an overall very correct result. As a complement, let's add that as the capacitive coupling with the ground through the coaxial cabling is increased, the cross-talk and difference in sensitivity vanish. In the case of EDELWEISS-III with a cabling of capacitance $>100$pF, the simple ionization signal generation model holds.




%\subsection{Axy-symmetrical} 
%
%Let's talk about the fact that I used 2D simulation which is then rotated to form a 3D simulation of cylindrical symmetry.
%
%2D simulations are quicker than 3D simulation.
%According to some quick tests, the simulation of a given geometry is the same in 3D or 2D.
%So yeah, using that.
%
%Maybe, search in the comsol manual and see how this is done in the equations.
%TO BE DONE.
%
%\begin{figure}
%\centering
%\begin{subfigure}{.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/2D_simulation.png}
%  \caption{Simulation of the concentric grid planar in 2D-axisymmetry with COMSOL.}
%  \label{fig:2D-simulation}
%\end{subfigure}%
%\begin{subfigure}{0.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/3D_simulation.png}
%  \caption{Simulation of the concentric grid planar in 3D with COMSOL.}
%  \label{fig:3D-simulation}
%\end{subfigure}
%\caption{To illustrate the differences between 2D and 3D.}
%\label{fig:2D-vs-3D}
%\end{figure}
%
%\subsection{Building the geometry}
%
%Assomptions used for the simulation (like perfect cylindrical symmetry)
%No simulation of the NTD, just test in 3D, no impact if put on electrode, but discussion and checking are necessary for that.
%
%\subsection{Meshing}
%
%Did I told you that comsol is a finte elements software ? no ? well, it is !
%These finite elements are small section of the geometric space where the calculationb of the physics quantities are calculated discritely. These finite elements are defined by the meshing, which divide the space. However, there is a way to divide space more efficiently than others. Like attribuating large portion of space where the physical quantities are quite constant and small portions where they are prone to a lot of fluctuation.
%And guess what I did with this fabulous option ?
%yeah, I kept it on full automatic for physics. Guess I should dig a bit deeper to see what this is all about. Like, size a mesh simplex according to the smallest feature in the geometry and things like that.
%TO BE DONE.
%
%\subsection{Capacitance Calculation}
%
%Everybody know that the capacitance $C$ links the voltage of an electrode $V$ and $Q$ the  charges accumulated in this electrode:
%\begin{equation}
%C \times U = Q
%\end{equation}
%
%This is quite basic, but no so evident when their is more than two electrodes with different electric potential in a system. That is why it is hopefully possible to generalized the notion of capacitance to more electrodes with the lumped matrix capacity or the Maxwell capacity matrix (consider whatever suits you, they mean the same).
%
%INSERT MATRIX HERE
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/lumped_capacitance_scheme.png}
%\caption{Scheme representing the capacitance between each electrodes in electric field simulation.}
%\label{fig:lumped-capacitance}
%\end{figure}
%
%How does comsol calculate this lumped capacitance matrix ?
%Well, it considers the equation i just wrote before, and fixes all except one electrode to zero and sweep over the electrodes with 1V of potential. Just with that, the software is able to deduce all the terms of the matrix.
%Yeah, i should read more about that in the manual to see if this is done like that. But it is. yep.
%TO BE DONE.
%
%
%CROSSTALK
%Yep, gotta talk about the link between the crosstalk on the ionization channels and the capacitance term between those electrodes.
%We can simply say for now that the higher the capacitance is and the higher the crosstalk will be. However, it should be very interesting to quantify the link between these two quantities.
%Linking the crosstalk matrix and the capacitance matrix, and be able to compare that experimentally.
%
%ANALYSIS TO BE DONE
%
%
%\subsection{Estimation of the Theoretical Fiducial Volume}
%
%In this subsection, i explain how to estimate the fiducial volume.
%Draw streamlines crossing the z=0.
%Exporting to image png.
%Using graphical analysis with python and rescaling to take into account 2D-axisymmetry.
%
%\begin{figure}
%\centering
%\begin{subfigure}{.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/streamlines_comsol.png}
%  \caption{Drawing streamlines in COMSOL}
%  \label{fig:streamlines-comsol}
%\end{subfigure}%
%\begin{subfigure}{0.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/streamlines_corrected.png}
%  \caption{for 4*4mm NTD}
%  \label{fig:streamlines-corrected}
%\end{subfigure}
%\caption{Illustration of the estimation of the fiducial volume.}
%\label{fig:fiducial-volume-estimation}
%\end{figure}
%
%\subsection{General region for the charge collection in a detector}
%
%WITH A SCHEME
%To illustrate the different region of the detector differing by the expected charge collection.
%
%\begin{itemize}
%	\item collecting zone
%	\item veto zone
%	\item guard zone
%	\item lost zone (streamlines exiting the crystal)
%	\item in between all of them, either low electric field (bad for trapping and recombination) or unclear frontier (when thinking of the recoil as a charged firework).
%\end{itemize}
%
%\section{Simulated Configurations}
%
%In this section, I will talk about the different configurations that were simulated.
%These configurations can differ according to the mass of the crystal, the number of electrodes, the position and geometry of the electrodes.
%Maybe, i should describe the configurations in a kind of general way: planar, grid, ID, FID, etc.. and put the exact simulation of each detectors in the annexes. I dont really know yet.
%
%\subsection{Planar Geometry}
%
%(Like REDN1 or RED80, with planar polarization, not much runs)
%
%\subsubsection{Full Planar}
%
%Maxwell Capacitance: $11.88 \times 10^{-12}$F
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/full_planar.png}
%\caption{Scheme of the simulated full planar h10phi30 detector.}
%\label{fig:full-planar}
%\end{figure}
%
%\subsubsection{Concentric/Square Grid Planar}
%
%Maxwell Capacitance: $11.88 \times 10^{-12}$F
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/concentric_grid_planar.png}
%\caption{Scheme of the simulated concentric grid planar h10phi30 detector.}
%\label{fig:concentric-grid-planar}
%\end{figure}
%
%\subsection{Planar with Guard}
%
%Like RED80, many runs.
%
%\subsection{Interdigitized}
%
%Like REDN1, many runs.
%
%Lot of different variants here.
%
%On the presented figure, the central pad is chosen to be polarized at veto potential and the NTD thermal sensor should be glued on it.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/ID_geometry.png}
%\caption{Scheme of the simulated interdigitized detector.}
%\label{fig:concentric-grid-planar}
%\end{figure}
%
%\subsection{Fully Interdigitized}
%
%Like RED70 (no run, RIP)
%
%Presenting the FID geometry, with veto zone, collect, zone and the faraday cages effect which means that the charge collection is *really* good.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/placeholder.jpg}
%\caption{Illustrating the veto zone and the collect zone thanks to the electric field shape induced by the FID electrodes.}
%\label{fig:fid-illustration}
%\end{figure}
%
%\subsection{Comparing the different topologies}
%
%\begin{table}[]
%\centering
%\resizebox{\linewidth}{!}{
%	\input{Tables/Electrodes/performance_overview.tex}
%}
%\caption{Sum-up of the performance and specificity of each electrode topology.}
%\label{tab:stream-glitch-time-cut}
%\end{table}
%
%\section{Influence of parameters}
%
%For each parameter, we want to study their impact on the performances of the detector.
%The fiducial volume, the electric field shape, the electric field norm and the capacitance.
%
%The fiducial volume is a number.
%The electric field shape/norm is one or two graphs.
%The capacitance is a matrix (non-diagonal term are useful to estimate the coupling between each electrodes)
%
%\subsection{Capacitance with chassis distance}
%
%*All topologies*
%
%The capacitance term between the electrodes and the ground decreases with the distance of the copper chassis. As expected by the capacitance formula of a plan capacitor.
%The capacitance term capa-capa tends to the expected value for a plan capacitor in empty space.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/capacitance_chassis_distance.png}
%\caption{Graph of the capacitance terms in function of the distance between the Ge crystal and the copper chassis (concentric grid planar h10phi30 detector).}
%\label{fig:capcaitance-chassis-distance}
%\end{figure}
%
%\subsection{Capacitance with electrode spacing}
%
%*All topologies except full planar*
%
%The electrode spacing directly fixes the number of concentric circle on a plan face of the germanium crystal. As a result the curves show a saw-shaped profile corresponding to the discrete number of electrodes.
%Anyway, the global trend is that with a high spacing, there is less electrodes and less capacitance.
%
%This tells us that we want to reduce the surface of electrode on the crystal in order to decrease the capacitance. However, a lower surface of electrodes comes with a worse charge collection eventually. So trade-off time.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/capacitance_electrode_spacing.png}
%\caption{Graph of the capacitance terms in function of the electrode spacing (concentric grid planar h10phi30 detector).}
%\label{fig:capacitance-electrode-spacing}
%\end{figure}
%
%\begin{figure}
%\centering
%\begin{subfigure}{.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/2x2_distance_sweep.png}
%  \caption{for 2*2mm NTD}
%  \label{fig:2D-simulation}
%\end{subfigure}%
%\begin{subfigure}{0.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/4x4_distance_sweep.png}
%  \caption{for 4*4mm NTD}
%  \label{fig:3D-simulation}
%\end{subfigure}
%\caption{Graph of the capacitance terms in function of the electrode spacing (interdigitized).}
%\label{fig:2D-vs-3D}
%\end{figure}
%
%I could also mention the projection for the fid32 and fid38 that were simulated with different electrode spacing.
%
%\begin{table}[]
%\centering
%\resizebox{\linewidth}{!}{
%	\input{Tables/Electrodes/fid32_parameter_sweep.tex}
%}
%\caption{Projection of the FID32 design performance with multiple variants (collect at $\pm4$V, veto at $\mp1.5$V)}
%\label{tab:stream-glitch-time-cut}
%\end{table}
%
%\begin{table}[]
%\centering
%\resizebox{\linewidth}{!}{
%	\input{Tables/Electrodes/fid38_parameter_sweep.tex}
%}
%\caption{Projection of the FID38 design performance with multiple variants. (collect at $\pm4$V, veto at $\mp1.5$V)}
%\label{tab:stream-glitch-time-cut}
%\end{table}
%
%\subsection{Capacitance with the electrode width}
%
%*All topologies except full planar*
%
%As expected, increasing the width of electrodes also increases the surface of the electrodes and the capacitance of the detector.
%Some configurations are more affected than others: planar detector less affected than the interleaved electrode configurations.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/capacitance_electrode_spacing.png}
%\caption{Graph of the capacitance terms in function of the electrode width (concentric grid planar h10phi30 detector).}
%\label{fig:capacitance-electrode-width}
%\end{figure}
%
%\subsection{Potential of the veto/guard electrodes}
%
%*Planar with guard, ID and FID*
%
%When considering geometry with veto or guards electrodes, the potential of these electrodes in respect to the main collecting electrodes is a parameter.
%Changing this parameter has an impact on the shape of the streamline of the electric field in the detector.
%
%\begin{figure}
%\centering
%\begin{subfigure}{.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/potential_veto_0.png}
%  \caption{ratio veto/collect: 0.21}
%  \label{fig:ratio-veto-0}
%\end{subfigure}%
%\begin{subfigure}{0.5\textwidth}
%  \centering
%  \includegraphics[width=\linewidth]{Figures/Electrodes/potential_veto_1.png}
%  \caption{ratio veto/collect: 0.13}
%  \label{fig:veto-ratio-1}
%\end{subfigure}
%\caption{Illustration of the estimation of the fiducial volume.}
%\label{fig:veto-ratio}
%\end{figure}
%
%\subsection{Symmetry of the polarization}
%
%*All topologies*
%
%Checking that a symmetric polarization is better than asymmetric,
%and showing some numbers/graphs to justify that
%($\pm1$V is better than 0,2V)
%
%\subsection{Central hole/pad for NTD}
%
%*All topologies*
%
%Impact of a hole/pad for the NTD. Important for electric field shape.
%Should be decided by the experimental heat-only rate.
%
%\subsection{Corner of the crystal}
%
%*All topologies*
%
%No electrodes or electrodes on/near the corner.
%Impact of the charge collection, "dead" volume in the corner.
%
%\subsection{Equatorial distance}
%
%*Planar extreme, Planar with guard, FID*
%
%Equatorial length, discussion on charge collection/trapping/tagging on this equatorial volume.
%
%\section{Experiment with REDN1}
%
%In this section, experiment with the ionization channel of REDN1, and analysis and results and comparison with expected performances. This is based on the run61.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/redn1_ion_vs_ion.png}
%\caption{For each fiducial events of the run tk15l005, comparing the reconstructed ionization energy for each electrodes.}
%\label{fig:redn1-ion-vs-ion}
%\end{figure}
%
%\begin{table}[]
%\centering
%\resizebox{\linewidth}{!}{
%	\input{Tables/Electrodes/redn1_fiducial_volume.tex}
%}
%\caption{Estimation of the experimental fiducial volume for REDN1.}
%\label{tab:stream-glitch-time-cut}
%\end{table}
%
%\subsection{Experimental fiducial volume}
%
%\subsection{Experimental Charge collection}
%
%\subsection{Experimental sensitivity and crosstalk}
%
%
%\section{Experiment with RED80}
%
%\subsection{Experimental fiducial volume}
%
%\subsection{Experimental Charge collection}
%
%\subsection{Experimental sensitivity and crosstalk}
%
%
%\section{Appendix: Catalog of Detectors fields lines}
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{Figures/Electrodes/streamlines_red80.png}
%\caption{Streamlines of the electric field in RED80.}
%\label{fig:streamlines-red80}
%\end{figure}
